---
tags: asynchronous, i/o
---
## 비동기의 의미

컴퓨터 과학에서 비동기 작업은 **프로세스가 다른 프로세스와 독립적으로 작동하는 것을 의미한다.**

<aside>
💡  동기 작업은 다른 프로세스가 완료되거나 핸드오프될 때만 프로세스가 실행되는 것을 의미합니다.

</aside>

### 예시

비동기적으로 작동하는 프로그램의 간단한 예로 프린터의 내장 소프트웨어를 들 수 있습니다.

프린터가 사용자에게 토너 부족 경고를 보내도 프린터는 계속 인쇄합니다. 

프린터는 경고를 발행하기 위해 모든 작업을 중지했다가 다시 시작하지 않습니다.

경고를 발행하는 프로그램 부분은 인쇄를 트리거하는 부분에 종속되지 않습니다. 

독립적으로 작동하기 때문에 동시에 발생할 수 있습니다.x 

### 프로그래밍 언어에서의 비동기

비동기 프로그래밍을 가능하게 하는 기능을 **콜백 함수**라고 합니다.

자바스크립트에서는 함수에 중첩된 모든 연산이 웹 애플리케이션이나 데이터베이스로 전송되어 나머지 프로그램이 계속 실행되는 동안 필요한 정보를 수집합니다. 

정보가 수집되면 **프로그램을 통해 다시 전송되어 해당 정보에 의존하는 프로그램 내 함수에 적용되는 것이 바로 콜백**입니다.

## 비동기 I/O는 어떻게 동작할까?

![Untitled](Untitled%2080.png)

1. 스레드는 커널에 수행하고자 하는 I/O 작업을 요청합니다.
    
    <aside>
    💡 socket 이나 파일 읽기/쓰기 작업 등
    
    </aside>
    
2. 커널은 요청을 모니터링하기 위해 스레드에 핸들을 제공합니다.
3. 커널은 요청을 베이비시팅할 항목 목록에 추가합니다.
    
    <aside>
    💡 베이비시팅은 무언가를 모니터링 및 감독하는 것을 의미합니다.
    
    </aside>
    
4. 스레드는 주기적으로 I/O 핸들에서 이벤트가 있는지 확인하면서 계속 수명을 유지합니다.
5. 커널은 작업이 발생할 때마다 I/O 핸들에 이벤트를 게시합니다.
6. 스레드는 각 이벤트를 가져와 처리하고 요청된 작업이 완료될 때까지 더 많은 이벤트가 있는지 확인합니다.

## OS 에서의 비동기

![Untitled](Untitled%2081.png)

### 시스템 콜(System Call)

시스템 콜은 컴퓨터 프로그램이 실행되는 운영 체제의 커널에 서비스를 요청하는 프로그래밍 방식입니다.

<aside>
💡 하드웨어 관련 서비스(하드 디스크 접근 또는 외부 장치 접근), 새 프로세의 생성 및 실행, 프로세스 스케줄링과 같은 통합 커널 서비스등이 포함된다.

</aside>

시스템 콜은 프로세스와 운영체제 간 필수 인터페이스를 제공한다.

### 업 콜(Up Call)

> 간략하게 말해서, kernel 에서 process에게 그 process가 요구한 일이 끝났음을 알리는 신호
> 

애플리케이션과 운영체제 커널 간의 대부분의 통신에 시스템 호출을 사용할 수 있습니다.
대부분의 통신에 시스템 호출을 사용할 수 있습니다. 

하지만 애플리케이션이 운영체제와 같은 기능을 구현할 수 있도록 하려면 그 이상의 무언가가 필요한데 운영체제 커널의 일부를 가상화하여 인터럽트 및 예외를 제공하는 것을 업 콜이라고 한다.

<aside>
💡 UNIX 에서는 시그널, Windows 에서는 비동기 이벤트라고 부른다.

</aside>

### 업콜을 통한 즉각적인 이벤트 전달이 유용한 경우

1. ****************비동기 I/O 의 알림****************
    
    비동기 요청에 대한 시스템 콜에 대해 I/O 작업이 완료되었을 때 업콜을 통해 애플리케이션에 별도의 알림을 보낼 수 있습니다.
    
2. **프로세스 간 통신**
    
    한 프로세스가 다른 프로세스에게 즉각적인 요청을 수행해야할 때 업콜을 사용하여 알립니다.
    

## 마치며

비동기 I/O 를 프로그래밍 언어에서 처리하는 수준이 아닌 로우 레벨까지 간단하게 살펴보며 실제로 어떻게 비동기가 작동하는 가에 대한 의문을 어느정도 해결하였습니다.

단순한 데이터 처리같은 경우는 동기 방식으로 프로그램을 작성하는 것이 혼란 방지나 정보 교환을 복잡하게 만드는 비동기보다 나을 수 있겠지만 오늘 날 프로그램들은 많은 복잡도를 요구하기 때문에 비동기 작업이 필수인 것 같습니다.

## References

****[What is `Asynchronous I/O`?](https://medium.com/nerd-for-tech/what-is-asynchronous-i-o-b37994359471)****

****[How Async I/O Works](https://blog.kgriffs.com/2012/09/18/demystifying-async-io.html#id-1.ftn)****

****[[OS] upcall , callback 차이](https://junp.tistory.com/289)****