많은 회사와 조직이 제품의 모든 컴포넌트에 대해 도커 이미지를 빌드하고 용량이 점점 커지고 있으며 그에 따라
CI 빌드에 걸리는 시간도 점점 길어지고 있습니다.
이상적인 CI 빌드 타임은 5분 이상이 걸리지 않는 것이며 이보다 빌드 타임이 오래걸리면 생산성이 저하된다고 생각합니다.
![[Pasted image 20231128111644.png]]


이 글에서 빌드시간을 대폭 개선한 두 가지 작은 변경사항을 설명합니다.
설명 이전에 다음과 같은 [Docker파일 작성 모범 사례](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)도 참고하세요.

- 레이어 수 최소화
- ==다단계 빌드 사용==
- 최소한의 기본 이미지 사용

# Buildkit 과 Buildx
## Buildkit
빌드킷은 레거시 Docker 빌더를 대체하기 위해 개선된 백엔드입니다.
2018년부터 Docker 와 함께 패키지로 제공되며 Docker 엔진 23.0 부터 기본 빌더가 되었습니다.
주요기능은 다음과 같습니다.
* 향상된 캐싱 기능
* 별개의 레이어 빌드 병렬 처리
* 기본 이미지 지연 풀링

빌드킷을 사용하면 도커 빌드 명령의 출력이 더 깔끔하고 체계적으로 보입니다.

## Buildx
Docker 에서 빌드킷의 잠재력을 최대한 활용할 수 있도록 해주는 Docker용 플러그인입니다.
빌드엑스는 빌드킷이 이전 버전과 호환되는 방식으로 도커 빌드 명령에 모두 통합할 수 없는 많은 새로운 구성옵션을 지원합니다.

빌드엑스는 이미지 빌드 외에도 여러 빌더 관리를 지원합니다.
이는 공유 Docker 데몬을 수정하지 않으므로 CI에서 고유한 구성으로 범위가 지정된 환경을 정의하는 데 유용할 수 있습니다.

다음과 같이 빌드엑스를 시작할 수 있습니다.
```bash
docker buildx create --bootstrap --name builder  
docker buildx use builder
```

