---
tags: load-balancer
---
# Load Balancer vs. Reverse Proxy vs. API Gateway

태그: ALB, HAProxy, 로드 밸런서
Date: September 7, 2023 12:22 AM
공개 여부: 공개
설명: 서로 비슷하면서 지원하는 기능이 다르다.
카테고리: 인프라

# Load Balancer

![Load Balancer](Untitled%2052.png)

Load Balancer

최적의 리소스 활용을 보장하고 처리량을 극대화하며 응답 시간을 최소화하는 역할을 수행합니다.

## 4계층 로드밸런서 vs 7계층 로드밸런서

**전송 계층 로드밸런서:** IP 주소 및 TCP/UDP 포트와 같은 네트워크 수준 정보를 기반으로 결정을 내립니다.

**응용 계층 로드밸런서:** HTTP 헤더, 쿠키, URL 경로를 활용하여 보다 세분화된 결정을 내립니다.

<aside>
✨ 애플리케이션에 가장 적합한 접근 방식은 요구 사항에 따라 다르며, 각 계층 간 차이를 이해하는 것이 중요합니다.

</aside>

## 로드밸런서의 이점

시간 당 2백만 건 이상의 트랜잭션을 처리하는 전자상거래 대기업 Amazon 을 예로 들었을 때,

로드 밸랜서는 고가용성 및 내결함성을 보장하고 워크로드를 균등하게 분산하며 서버 장애 발생 시 트래픽 경로를 재지정합니다.

<aside>
✨ **워크로드(workload)?**

고객 대면 애플리케이션이나 백엔드 프로세스 같이 비즈니스 가치를 창출하는 리소스 및 코드 모음

주어진 기간에 시스템에 의해 실행되어야 할 작업의 할당량을 의미

</aside>

<aside>
✨ 고가용성 및 내결함성 보장, 워크로드 균등 분배, 장애 발생 시 경로 재지정

</aside>

따라서 트래픽이 폭주하거나 서버가 중단되는 경우에도 애플리케이션을 원활하게 실행할 수 있습니다.

# Reverse Proxy

![Reverse Proxy](Untitled%2053.png)

Reverse Proxy

웹 애플리케이션의 보안, 유지보수성 향상을 위한 구성요소 입니다.

## 응용 계층에서 작동

리버스 프록시는 7계층에서 동작합니다.

즉 HTTP 수준에서 요청과 응답을 처리하여 고급 기능을 제공할 수 있습니다.

예를 들어, URL 재작성을 수행하여 복잡한 URL 을 간소화하고 SEO를 개선할 수 있습니다.

## 기능 및 이점

SSL 종료 및 콘텐츠 압축같은 리소스 집약적인 작업을 WAS에서 처리한다고 가정했을 때 너무 많은 요청에 대해서 WAS 에 부하가 걸릴 수 있습니다.

이러한 작업을 리버스 프록시 서버에서 대신 수행할 수 있으므로 WAS 는 핵심 작업에 집중할 수 있게됩니다.

<aside>
✨ 압축, SSL 등 작업을 대신 처리하여 WAS 의 부하를 낮춤
→ 성능 향상 및 서버 부하 감소

</aside>

또한 리버스 프록시는 들어오는 요청을 필터링하고 악성 트래픽으로부터 WAS 를 보호하는 방화벽 역할을 수행할 수 있습니다.

<aside>
✨ 액세스 제어 구현, 악성 트래픽 차단
→ 보안 강화 및 민감한 데이터 보호

</aside>

# API Gateway

![Untitled](Untitled%2054.png)

API Gateway 는 관리를 중앙 집중화하고, 보안을 강화하며, 확장성을 보장하는 최고의 솔루션입니다.

<aside>
✨ 마이크로서비스 기반의 애플리케이션을 효율적으로 중앙 집중식으로 관리할 수 있습니다.

</aside>

## 기능 및 이점

**인증 및 인가 관리:** 인증은 API 보안을 위해 매우 중요하며, API 게이트웨이는 이 작업에 탁월합니다. 

API 게이트웨이는 중앙 집중식 인증 및 권한 부여를 구현함으로써 여러 서비스에서 보안 조치를 중복할 필요가 없으므로 보안 관리를 간소화하고 취약성 위험을 줄일 수 있습니다.

<aside>
✨ 한 포인트에서 인증 및 인가를 관리할 수 있으므로 최소 보안 영역을 유지할 수 있다.

</aside>

**속도 제한:** API 게이트웨이는 속도 제한을 지원하여, 요청이 많은 시간 대에도 속도 제한을 적용하여 백엔드 서비스의 안정성과 성능을 유지할 수 있습니다.

 **요청 및 응답 데이터 변환:** 필요에 따라 요청과 응답을 수정할 수 있으므로 API 페이로드를 수정하거나, 데이터 형식을 변환하거나, 사용자 정의 헤더를 추가할 수 있어 애플리케이션의 유연성과 적응성이 추가되어 시간이 지남에 따라 쉽게 개선할 수 있습니다.

**모니터링 및 로깅:** 모니터링과 로깅은 애플리케이션을 정상적으로 유지 관리하는 데 필수적이며, API 게이트웨이가 이를 지원합니다. 

API 게이트웨이는 중앙 집중식 모니터링 및 로깅 기능을 제공함으로써 전체 애플리케이션에서 성능을 추적하고, 문제를 진단하고, 추세를 쉽게 파악할 수 있도록 지원합니다.

> 2억 명이 넘는 가입자를 보유한 넷플릭스를 예를 들어,
넷플릭스는 광범위한 마이크로서비스 아키텍쳐를 관리하기 위해  API 게이트웨이를 사용하며,
매일 수백만 건 API 호출을 처리할 수 있는 확장 가능하고 안전한 솔루션을 제공하고 있습니다.
> 

# 그래서, 로드 밸런서, 리버스 프록시, API Gateway의 차이점은 무엇?

로드 밸런서와 리버스 프록시를 보았을 때 어떤 점이 다른가를 우선 살펴봅시다.

두 구성 요소 모두 요청을 분산하지만 **로드 밸런서는 주로 여러 백엔드 서버에 트래픽을 분산하여 성능, 가용성 및 내결함성을 개선하는 데 중점을 둡니다.**

반면 **리버스 프록시는 애플리케이션 계층에서 작동하며 URL 재작성, 콘텐츠 압축, 액세스 제어와 같은 추가 기능을 제공합니다.**

두 개중 어느것이 가장 최선의 선택인 지는 애플리케이션의 수준과 요구 기능에 따라 다릅니다.

그렇다면 API Gateway는 어떤 경우에 적합할까요?

API 게이트웨이는 **여러 API에 중앙 집중식 관리, 보안, 확장성이 필요한 마이크로서비스 아키텍처에 가장 적합합니다.** 로드 밸런서나 리버스 프록시와 달리 API 게이트웨이는 인증, 속도 제한, 요**청/응답 변환, 모니터링과 같은 고급 기능을 제공**합니다.

![Untitled](Untitled%2055.png)

# 인기 있는 도구들 및 솔루션

## 로드 밸런서: HAProxy, NGINX, Amazon ELB

로드 밸런서에 관해서는 오픈 소스 고성능 TCP/HTTP 로드 밸런서인 HAProxy를 추천합니다. 

GitHub 및 Stack Overflow와 같은 거대 기술 기업이 신뢰하는 HAProxy는 레이어 4 및 레이어 7 로드 밸런싱, SSL 종료, 상태 확인 등 다양한 기능을 제공합니다.

[[HAProxy]HAProxy 란?](https://leffept.tistory.com/309)

또한 클라우드 기반으로 이용한다면 Amazon ELB 도 존재합니다.

![Untitled](Untitled%2056.png)

> Elastic Load Balancing(ELB)은 하나 이상의 가용 영역(AZ)에 있는 여러 대상 및 가상 어플라이언스에서 들어오는 애플리케이션 트래픽을 자동으로 분산합니다.
> 

[웹 서버 로드 밸런싱 | 서버 로드 밸런싱 | Amazon Web Services](https://aws.amazon.com/ko/elasticloadbalancing/)

# References

[Load Balancer vs. Reverse Proxy vs. API Gateway](https://medium.com/geekculture/load-balancer-vs-reverse-proxy-vs-api-gateway-e9ec5809180c)

[로드 밸런서 유형 - Amazon Elastic Container Service](https://docs.aws.amazon.com/ko_kr/AmazonECS/latest/developerguide/load-balancer-types.html)