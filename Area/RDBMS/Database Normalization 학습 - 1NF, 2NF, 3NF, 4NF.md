# 정규화의 이점

![Untitled](Untitled%2057.png)

- 이해하기 쉽다.
- 개선 및 확장이 용이하다.
- 이상현상 방지
    - 삽입 이상, 갱신 이상, 삭제 이상

중복 데이터가 스며들 수 있는 위험이 있는 지 평가하는 기준으로 제 1, 제 2, … 5정규화 까지 과정이 규정되어있다.

## 제 1 정규화 (1NF)

> 도메인 원자값이라는 조건을 만족해야 한다.
> 

### 도메인 원자 값 조건

- 반복 그룹이 존재해서는 안된다.
- 모든 행은 식별자로 완전하게 구분되어야 한다.

### 어떻게 하면 위반하게 되는 가?

행 순서를 사용하여 정보를 전달하면 1NF 를 위반하게 된다.

기본 키 없이 테이블을 설계한다.

반복그룹이 존재한다.

### 반복 그룹의 단점

![Untitled](Untitled%2058.png)

게임 DB의 플레이어 인벤토리 테이블으 예시로 몇 개의 아이템이 올지… 어떤 아이템이 올지 반복적으로 표현한다면 DB 실행 계획이 복잡해지고 인덱스 성능이 떨어진다.

![Untitled](Untitled%2059.png)

다음과 같이 반복되는 컬럼을 분리한다면 더 이해하기 쉽고 단순하게 쿼리를 변경할 수 있다.

### 1NF 정리

![Untitled](Untitled%2060.png)

1. 행 순서를 사용하여 정보를 전달하지 않아야 한다.
2. 동일한 열 내에서 데이터 유형을 혼합하지 말아야 한다.
3. 기본 키 없이 테이블을 설계하지 말아야 한다.
4. 반복 그룹을 허용하지 말아야 한다. 

## 제 2 정규화 (2NF)

> 후보키 K와 K에 속하지 않는 속성 A가 있을 때, A를 결정하기 위해 K의 일부가 아닌 K 전체를 참조해야만 하는 경우 1NF 테이블은 2NF이다.
> 

예시로 이해해보자.

![Untitled](Untitled%2061.png)

1NF 예시 테이블에 게임 플레이어에 대한 등급 칼럼이 추가되었을 때 다음과 같은 문제가 발생한다.

1. trev73 이 4열이 존재하니 Advanced 도 4번 존재해야 한다.
2. gila19 가 모든 코인을 잃었을 때 (row가 삭제) **rating 을 조회할 수 없게 된다! ( deletion anomaly )**
3. jdog21 의 등급이 업데이트되어 변경되었을 때 **레코드 하나만 수정되어 2개의 등급을 가지게 될 수 있다. ( update anomaly )**
    
    ![Untitled](Untitled%2062.png)
    

1. tina63 이라는 유저의 등급을 기록하고 싶은데 **해당 유저의 인벤토리에 아무것도 없으므로** 등급을 DB에 저장할 수 없다. **( insertion anomaly )**

즉 이러한 예시들의 문제는 Player_Rating 이 기본 키에 속하지 않는 컬럼이기 때문이다.

**즉 제 2NF 의 목적은 테이블의 키가 아닌 각 속성이 전체 기본 키에 속해야 한다는 것이다.**

![Untitled](Untitled%2063.png)

![Untitled](Untitled%2064.png)

다음 그림은 2NF 과정을 거친 테이블 결과이다.

두 테이블은 모두 부분 키 종속성이 없으며 모든 속성은 기본 키의 종속되어 있다고 말할 수 있다.

따라서 해당 테이블들은 제 2 정규형이다.

## 제 3정규화 (3NF)

> 제 2정규형을 만족하고, 테이블 내의 모든 속성이 키에만 의존하며 다른 후보키에 의존하지 않는다.
> 

![Untitled](Untitled%2065.png)

Player_Skill_Level 에 의해 Player_Rating 이 결정된다고 할 때,

gila19 의 Skill_Level 은 상승했지만, Rating 은 그대로인 데이터 불일치 문제가 발생한다.

이는 Rating 이 기본 키가 아닌 Skill 에 의존하기 때문에 발생하는 문제이다.

해당 테이블을 3NF 과정을 거치면 다음과 같다.

![Untitled](Untitled%2066.png)

3NF의 목적은 다음과 같다.

**테이블의 모든 키가 아닌 속성은 키, 전체 키에만 의존해야 한다.**

여기까지 작업되었다면 대부분 정규화 된 테이블 디자인이며, 부족한 경우 더 나아가 4NF, 5NF 를 수행할 수 있다.

4, 5 는 영상 참고